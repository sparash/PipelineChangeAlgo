Current directory: /home/sparashsh63nexl
Files in directory: ['All_Algo_Report_theory.ipynb', 'feature_importance.png', 'Project_ASMA.ipynb', 'Admission_Prediction_Sparash.ipynb', 'All_Algo_Report (1).ipynb', 'Project_Alto (1).ipynb', 'actual_vs_predicted.png', '.config', 'Capstone_Project_Sparash.ipynb', 'correlation_heatmap.png', 'JaroWrinklerPySpark.ipynb', 'CapstoneMedicalInsurance.ipynb', 'PreTrainMCC final (1).ipynb', 'CapstoneProject.ipynb', 'PreTrainwithoutmcc.ipynb', 'HybridStringAlgo.ipynb', 'Job_Skill_Case_Study.ipynb', 'Untitled3.ipynb', 'RS_3_3_Day1_2_3_2025.ipynb', 'PreTrainMCC final.ipynb', 'acronym_similarity_results.csv', 'threshold_sensitivity.png', 'admission_data.csv', 'Class_Rough.ipynb', 'merchant_matcher.pkl', 'Untitled1.ipynb', 'JaroPyspark (1) (1).ipynb', 'challenge_types.png', '.ipynb_checkpoints', 'cosine_similarity.jpg', 'Acronym.xlsx', 'Project_Alto.ipynb', 'All_Algo_Report.ipynb', 'score_by_expected_match.png', 'Acronym_Categorized.xlsx', 'JaroPyspark.ipynb', 'Appraisal_Reference_Data.csv', 'score_distribution.png', 'Untitled5.ipynb', 'model_comparison.png', 'Lab_Work_1.ipynb', 'correlation.jpg', '.jupyter', 'eda_visualizations.png', '.bashrc', 'ML_Regression.ipynb', '.ipython', 'Untitled.ipynb', '.local', 'insurance_charges_prediction_model.pkl', '.bash_logout', 'Untitled4.ipynb', 'Capstone Project_Insurance Analytics.csv', 'UBCF.png', 'JaroPyspark (1) (2).ipynb', 'similarity_matching_report.md', 'MultipleRegre.csv', 'Untitled2.ipynb', 'IBCF.png', 'TF_IDF_Final (1).ipynb', 'HybridAlgo (1).ipynb', 'JaroPyspark_Final.ipynb', 'job_skills_data.csv', '.profile', 'residual_analysis.png', 'LinearRegression_CO2.ipynb']
Initializing MerchantMatchingSystem...
Attempting to load model: all-MiniLM-L6-v2
No sentence-transformers model found with name sentence-transformers/all-MiniLM-L6-v2. Creating a new one with mean pooling.
Could not cache non-existence of file. Will ignore error and continue. Error: [Errno 13] Permission denied: '/home/jovyan/.cache'
Could not load SentenceTransformer model: Unrecognized model in sentence-transformers/all-MiniLM-L6-v2. Should have a `model_type` key in its config.json, or contain one of the following strings in its name: albert, align, altclip, aria, aria_text, audio-spectrogram-transformer, autoformer, aya_vision, bamba, bark, bart, beit, bert, bert-generation, big_bird, bigbird_pegasus, biogpt, bit, blenderbot, blenderbot-small, blip, blip-2, bloom, bridgetower, bros, camembert, canine, chameleon, chinese_clip, chinese_clip_vision_model, clap, clip, clip_text_model, clip_vision_model, clipseg, clvp, code_llama, codegen, cohere, cohere2, colpali, conditional_detr, convbert, convnext, convnextv2, cpmant, ctrl, cvt, dab-detr, dac, data2vec-audio, data2vec-text, data2vec-vision, dbrx, deberta, deberta-v2, decision_transformer, deformable_detr, deit, depth_anything, depth_pro, deta, detr, diffllama, dinat, dinov2, dinov2_with_registers, distilbert, donut-swin, dpr, dpt, efficientformer, efficientnet, electra, emu3, encodec, encoder-decoder, ernie, ernie_m, esm, falcon, falcon_mamba, fastspeech2_conformer, flaubert, flava, fnet, focalnet, fsmt, funnel, fuyu, gemma, gemma2, gemma3, gemma3_text, git, glm, glpn, got_ocr2, gpt-sw3, gpt2, gpt_bigcode, gpt_neo, gpt_neox, gpt_neox_japanese, gptj, gptsan-japanese, granite, granitemoe, granitemoeshared, granitevision, graphormer, grounding-dino, groupvit, helium, hiera, hubert, ibert, idefics, idefics2, idefics3, idefics3_vision, ijepa, imagegpt, informer, instructblip, instructblipvideo, jamba, jetmoe, jukebox, kosmos-2, layoutlm, layoutlmv2, layoutlmv3, led, levit, lilt, llama, llava, llava_next, llava_next_video, llava_onevision, longformer, longt5, luke, lxmert, m2m_100, mamba, mamba2, marian, markuplm, mask2former, maskformer, maskformer-swin, mbart, mctct, mega, megatron-bert, mgp-str, mimi, mistral, mistral3, mixtral, mllama, mobilebert, mobilenet_v1, mobilenet_v2, mobilevit, mobilevitv2, modernbert, moonshine, moshi, mpnet, mpt, mra, mt5, musicgen, musicgen_melody, mvp, nat, nemotron, nezha, nllb-moe, nougat, nystromformer, olmo, olmo2, olmoe, omdet-turbo, oneformer, open-llama, openai-gpt, opt, owlv2, owlvit, paligemma, patchtsmixer, patchtst, pegasus, pegasus_x, perceiver, persimmon, phi, phi3, phimoe, pix2struct, pixtral, plbart, poolformer, pop2piano, prompt_depth_anything, prophetnet, pvt, pvt_v2, qdqbert, qwen2, qwen2_5_vl, qwen2_audio, qwen2_audio_encoder, qwen2_moe, qwen2_vl, rag, realm, recurrent_gemma, reformer, regnet, rembert, resnet, retribert, roberta, roberta-prelayernorm, roc_bert, roformer, rt_detr, rt_detr_resnet, rt_detr_v2, rwkv, sam, seamless_m4t, seamless_m4t_v2, segformer, seggpt, sew, sew-d, shieldgemma2, siglip, siglip2, siglip_vision_model, smolvlm, smolvlm_vision, speech-encoder-decoder, speech_to_text, speech_to_text_2, speecht5, splinter, squeezebert, stablelm, starcoder2, superglue, superpoint, swiftformer, swin, swin2sr, swinv2, switch_transformers, t5, table-transformer, tapas, textnet, time_series_transformer, timesformer, timm_backbone, timm_wrapper, trajectory_transformer, transfo-xl, trocr, tvlt, tvp, udop, umt5, unispeech, unispeech-sat, univnet, upernet, van, video_llava, videomae, vilt, vipllava, vision-encoder-decoder, vision-text-dual-encoder, visual_bert, vit, vit_hybrid, vit_mae, vit_msn, vitdet, vitmatte, vitpose, vitpose_backbone, vits, vivit, wav2vec2, wav2vec2-bert, wav2vec2-conformer, wavlm, whisper, xclip, xglm, xlm, xlm-prophetnet, xlm-roberta, xlm-roberta-xl, xlnet, xmod, yolos, yoso, zamba, zamba2, zoedepth
Will use TF-IDF fallback for text similarity
MerchantMatchingSystem initialized successfully
Loading reference data...
Loading reference data from: Acronym_Categorized.xlsx
Detected Acronym_Categorized.xlsx format with columns: 'Acronym', 'Full Name', 'Merchant Category'
Building category-specific indices...
Generating TF-IDF vectors for category: Banking
Generating TF-IDF vectors for category: Telecom
Generating TF-IDF vectors for category: Government
Generating TF-IDF vectors for category: Insurance
Generating TF-IDF vectors for category: Automobile
Generating TF-IDF vectors for category: Grocery
Generating TF-IDF vectors for category: Misc Speciality
Generating TF-IDF vectors for category: Postal Service
Generating TF-IDF vectors for category: Sports
Generating TF-IDF vectors for category: Travel
Generating TF-IDF vectors for category: Software IT
Generating TF-IDF vectors for category: Pharmacy
Generating TF-IDF vectors for category: Beer Store
Generating TF-IDF vectors for category: Logistics
Generating TF-IDF vectors for category: Credit Agency
Generating TF-IDF vectors for category: Machinery
Generating TF-IDF vectors for category: Electric components
Generating TF-IDF vectors for category: Minning
Generating TF-IDF vectors for category: Electronics
Generating TF-IDF vectors for category: Restaurant
Generating TF-IDF vectors for category: Supermart
Generating TF-IDF vectors for category: Clothing
Generating TF-IDF vectors for category: Mens/womens wear
Generating TF-IDF vectors for category: Shoe Store
Built indices for 24 categories
Building acronym dictionary...
Built acronym dictionary with 75 unique acronyms across 76 categories
Loaded 98 reference merchants across 24 categories
Saving model...
Model saved to merchant_matcher.pkl
Processing with algorithm comparison...
Processing batch from: Acronym_Categorized.xlsx
Resolved acronym 'ANZ' to 'Australia and New Zealand Banking Group'
Resolved acronym 'Qantas' to 'Queensland and Northern Territory Aerial Services'
Resolved acronym 'CSL' to 'Commonwealth Serum Laboratories'
Resolved acronym 'AMP' to 'Australian Mutual Provident Society'
Resolved acronym 'BHP' to 'Broken Hill Proprietary Company'
Resolved acronym 'RACQ' to 'Royal Automobile Club of Queensland'
Resolved acronym 'RACV' to 'Royal Automobile Club of Victoria'
Resolved acronym 'NRMA' to 'National Roads and Motorists' Association'
Processed 10/98 rows
Resolved acronym 'AGL' to 'Australian Gas Light Company'
Resolved acronym 'ABC' to 'Australian Broadcasting Corporation'
Resolved acronym 'SBS' to 'Special Broadcasting Service'
Resolved acronym 'ACCC' to 'Australian Competition & Consumer Commission'
Resolved acronym 'ASIC' to 'Australian Securities and Investments Commission'
Resolved acronym 'ASX' to 'Australian Securities Exchange'
Resolved acronym 'CPA' to 'Certified Practising Accountants Australia'
Resolved acronym 'TAC' to 'Transport Accident Commission'
Resolved acronym 'VICSES' to 'Victoria State Emergency Service'
Processed 20/98 rows
Resolved acronym 'AFL' to 'Australian Football League'
Resolved acronym 'RBA' to 'Reserve Bank of Australia'
Resolved acronym 'Foxtel' to 'Fox News Corportaion & Telstra'
Resolved acronym 'SPC' to 'Shepparton Preserving Company'
Resolved acronym 'EVT' to 'Entertainment Ventures Travel Limted'
Resolved acronym 'MYOB' to 'Mind Your Own Business (business software)'
Resolved acronym 'ASC' to 'Australian Submarine Corporation'
Resolved acronym 'API' to 'Australian Pharmaceutical Industries'
Resolved acronym 'ABIE' to 'Australian Business in Europe'
Processed 30/98 rows
Resolved acronym 'ACP' to 'African Caribbean and Pacific'
Resolved acronym 'APEC' to 'Asia-Pacific Economic Cooperation'
Resolved acronym 'AQIS' to 'Australian Quarantine and Inspection Service'
Resolved acronym 'ATA' to 'Admission Temporaire/Temporary Admission Carnet'
Resolved acronym 'ATQ' to 'Autonomous Tariff Quotas'
Resolved acronym 'AWBC' to 'Australian Wine and Brandy Corporation'
Resolved acronym 'BTI' to 'Binding Tariff Information'
Resolved acronym 'CAP' to 'Common Agricultural Policy'
Resolved acronym 'CCP' to 'Common Commercial Policy'
Processed 40/98 rows
Resolved acronym 'CCT' to 'Common Customs Tariff'
Resolved acronym 'CECA' to 'Closer Economic Cooperation Agreement'
Resolved acronym 'CIF' to 'Cost Insurance and Freight'
Resolved acronym 'DFAT' to 'Department of Foreign Affairs and Trade'
Resolved acronym 'DFQF' to 'Duty-Free and Quota-Free'
Resolved acronym 'ECA' to 'Export Credit Agency'
Resolved acronym 'EFTA' to 'European Free Trade Association'
Resolved acronym 'EPA' to 'Economic Partnership Agreement'
Resolved acronym 'EU' to 'European Union'
Resolved acronym 'ACCC' to 'Australian Competition & Consumer Commission'
Processed 50/98 rows
Resolved acronym 'APRA' to 'Australian Prudential Regulation Authority'
Resolved acronym 'ATO' to 'Australian Taxation Office'
Resolved acronym 'NAB' to 'National Australia Bank'
Resolved acronym 'CBA' to 'Commonwealth Bank of Australia'
Resolved acronym 'AFSA' to 'Australian Financial Security Authority'
Resolved acronym 'AICD' to 'Australian Institute of Company Directors'
Resolved acronym 'AIIA' to 'Australian Information Industry Association'
Resolved acronym 'ALIA' to 'Australian Library and Information Association'
Resolved acronym 'ANSTO' to 'Australian Nuclear Science and Technology Organisation'
Resolved acronym 'APSC' to 'Australian Public Service Commission'
Processed 60/98 rows
Resolved acronym 'ARC' to 'Australian Research Council'
Resolved acronym 'ARIC' to 'Australian Research Integrity Committee'
Resolved acronym 'AWS' to 'Amazon Web Services'
Resolved acronym 'IBM' to 'International Business Machines'
Resolved acronym 'HP' to 'Hewlett-Packard'
Resolved acronym 'TCS' to 'Tata Consultancy Services'
Resolved acronym 'HDFC' to 'Housing Development Finance Corporation'
Resolved acronym 'ICICI' to 'Industrial Credit and Investment Corporation of India'
Resolved acronym 'KPMG' to 'Klynveld Peat Marwick Goerdeler'
Resolved acronym 'GE' to 'General Electric'
Processed 70/98 rows
Resolved acronym '3M' to 'Minnesota Mining and Manufacturing'
Resolved acronym 'BYD' to 'Build Your Dreams'
Resolved acronym 'LG' to 'Life is Good'
Resolved acronym 'NASA' to 'National Aeronautics and Space Administration'
Resolved acronym 'MCD' to 'Municipal Corporation Delhi'
Resolved acronym 'MCD' to 'McDonalds'
Resolved acronym 'MD' to 'McDonalds'
Resolved acronym 'MLD' to 'McDonalds'
Resolved acronym 'WLMRT' to 'Walmart Supercenter'
Processed 80/98 rows
Resolved acronym 'SBUX' to 'Starbucks Coffee'
Resolved acronym 'CVS' to 'CVS Pharmacy'
Processed 90/98 rows
Resolved acronym 'BofA' to 'Bank of America'

Algorithm Performance:
                       correct_matches  total_rows  accuracy  avg_score  \
smith_waterman                      90          98  0.918367  23.408163   
needleman_wunsch                    86          98  0.877551  22.663265   
monge_elkan                         83          98  0.846939   0.940564   
jaro_winkler                        81          98  0.826531   0.943298   
sorensen_dice                       79          98  0.806122   0.915469   
levenshtein                         78          98  0.795918   0.883590   
tfidf_cosine                        78          98  0.795918   0.870516   
jaccard                             78          98  0.795918   0.886198   
lcs_similarity                      78          98  0.795918   0.866592   
damerau_levenshtein                 78          98  0.795918   0.883590   
sbert_cosine                        78          98  0.795918   0.870516   
hybrid_category_aware               78          98  0.795918   0.903551   

                       avg_time_ms  
smith_waterman            0.084879  
needleman_wunsch          4.558101  
monge_elkan               0.039140  
jaro_winkler              0.018390  
sorensen_dice             0.011417  
levenshtein               0.029724  
tfidf_cosine              5.470568  
jaccard                   0.024759  
lcs_similarity            0.062162  
damerau_levenshtein       0.011648  
sbert_cosine              5.855845  
hybrid_category_aware     6.533263  
Processed 98 records. Results saved to algorithm_comparison_results.xlsx

Testing MCD disambiguation by category:
Resolved acronym 'MCD' to 'McDonalds'

Matches for 'MCD' in category 'Restaurant':
  - McDonalds (Category: Restaurant, Similarity: 1.0000)
  - McDonalds (Category: Restaurant, Similarity: 1.0000)
  - McDonalds (Category: Restaurant, Similarity: 1.0000)
  - Starbucks Coffee (Category: Restaurant, Similarity: 0.1834)
  - Starbucks Coffee (Category: Restaurant, Similarity: 0.1834)
Resolved acronym 'MCD' to 'Municipal Corporation Delhi'

Matches for 'MCD' in category 'Government':
  - Municipal Corporation Delhi (Category: Government, Similarity: 1.0000)
  - Australian Mutual Provident Society (Category: Government, Similarity: 0.3321)
  - Economic Partnership Agreement (Category: Government, Similarity: 0.3085)
  - European Union (Category: Government, Similarity: 0.3001)
  - Housing Development Finance Corporation (Category: Government, Similarity: 0.2846)

Successfully completed all operations!
