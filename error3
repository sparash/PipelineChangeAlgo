Current directory: /home/sparashsh63nexl
Files in directory: ['All_Algo_Report_theory.ipynb', 'feature_importance.png', 'Project_ASMA.ipynb', 'Admission_Prediction_Sparash.ipynb', 'All_Algo_Report (1).ipynb', 'Project_Alto (1).ipynb', 'actual_vs_predicted.png', '.config', 'Capstone_Project_Sparash.ipynb', 'correlation_heatmap.png', 'JaroWrinklerPySpark.ipynb', 'CapstoneMedicalInsurance.ipynb', 'PreTrainMCC final (1).ipynb', 'CapstoneProject.ipynb', 'PreTrainwithoutmcc.ipynb', 'HybridStringAlgo.ipynb', 'Job_Skill_Case_Study.ipynb', 'Untitled3.ipynb', 'RS_3_3_Day1_2_3_2025.ipynb', 'PreTrainMCC final.ipynb', 'acronym_similarity_results.csv', 'threshold_sensitivity.png', 'admission_data.csv', 'Class_Rough.ipynb', 'Untitled1.ipynb', 'JaroPyspark (1) (1).ipynb', 'challenge_types.png', '.ipynb_checkpoints', 'cosine_similarity.jpg', 'Acronym.xlsx', 'Project_Alto.ipynb', 'All_Algo_Report.ipynb', 'score_by_expected_match.png', 'Acronym_Categorized.xlsx', 'JaroPyspark.ipynb', 'Appraisal_Reference_Data.csv', 'score_distribution.png', 'Untitled5.ipynb', 'model_comparison.png', 'Lab_Work_1.ipynb', 'correlation.jpg', '.jupyter', 'eda_visualizations.png', '.bashrc', 'ML_Regression.ipynb', '.ipython', 'Untitled.ipynb', '.local', 'insurance_charges_prediction_model.pkl', '.bash_logout', 'Untitled4.ipynb', 'Capstone Project_Insurance Analytics.csv', 'UBCF.png', 'JaroPyspark (1) (2).ipynb', 'similarity_matching_report.md', 'MultipleRegre.csv', 'Untitled2.ipynb', 'IBCF.png', 'TF_IDF_Final (1).ipynb', 'HybridAlgo (1).ipynb', 'JaroPyspark_Final.ipynb', 'job_skills_data.csv', '.profile', 'residual_analysis.png', 'LinearRegression_CO2.ipynb']
Initializing MerchantMatchingSystem...
Attempting to load model: all-MiniLM-L6-v2
No sentence-transformers model found with name sentence-transformers/all-MiniLM-L6-v2. Creating a new one with mean pooling.
Could not cache non-existence of file. Will ignore error and continue. Error: [Errno 13] Permission denied: '/home/jovyan/.cache'
Could not load SentenceTransformer model: Unrecognized model in sentence-transformers/all-MiniLM-L6-v2. Should have a `model_type` key in its config.json, or contain one of the following strings in its name: albert, align, altclip, aria, aria_text, audio-spectrogram-transformer, autoformer, aya_vision, bamba, bark, bart, beit, bert, bert-generation, big_bird, bigbird_pegasus, biogpt, bit, blenderbot, blenderbot-small, blip, blip-2, bloom, bridgetower, bros, camembert, canine, chameleon, chinese_clip, chinese_clip_vision_model, clap, clip, clip_text_model, clip_vision_model, clipseg, clvp, code_llama, codegen, cohere, cohere2, colpali, conditional_detr, convbert, convnext, convnextv2, cpmant, ctrl, cvt, dab-detr, dac, data2vec-audio, data2vec-text, data2vec-vision, dbrx, deberta, deberta-v2, decision_transformer, deformable_detr, deit, depth_anything, depth_pro, deta, detr, diffllama, dinat, dinov2, dinov2_with_registers, distilbert, donut-swin, dpr, dpt, efficientformer, efficientnet, electra, emu3, encodec, encoder-decoder, ernie, ernie_m, esm, falcon, falcon_mamba, fastspeech2_conformer, flaubert, flava, fnet, focalnet, fsmt, funnel, fuyu, gemma, gemma2, gemma3, gemma3_text, git, glm, glpn, got_ocr2, gpt-sw3, gpt2, gpt_bigcode, gpt_neo, gpt_neox, gpt_neox_japanese, gptj, gptsan-japanese, granite, granitemoe, granitemoeshared, granitevision, graphormer, grounding-dino, groupvit, helium, hiera, hubert, ibert, idefics, idefics2, idefics3, idefics3_vision, ijepa, imagegpt, informer, instructblip, instructblipvideo, jamba, jetmoe, jukebox, kosmos-2, layoutlm, layoutlmv2, layoutlmv3, led, levit, lilt, llama, llava, llava_next, llava_next_video, llava_onevision, longformer, longt5, luke, lxmert, m2m_100, mamba, mamba2, marian, markuplm, mask2former, maskformer, maskformer-swin, mbart, mctct, mega, megatron-bert, mgp-str, mimi, mistral, mistral3, mixtral, mllama, mobilebert, mobilenet_v1, mobilenet_v2, mobilevit, mobilevitv2, modernbert, moonshine, moshi, mpnet, mpt, mra, mt5, musicgen, musicgen_melody, mvp, nat, nemotron, nezha, nllb-moe, nougat, nystromformer, olmo, olmo2, olmoe, omdet-turbo, oneformer, open-llama, openai-gpt, opt, owlv2, owlvit, paligemma, patchtsmixer, patchtst, pegasus, pegasus_x, perceiver, persimmon, phi, phi3, phimoe, pix2struct, pixtral, plbart, poolformer, pop2piano, prompt_depth_anything, prophetnet, pvt, pvt_v2, qdqbert, qwen2, qwen2_5_vl, qwen2_audio, qwen2_audio_encoder, qwen2_moe, qwen2_vl, rag, realm, recurrent_gemma, reformer, regnet, rembert, resnet, retribert, roberta, roberta-prelayernorm, roc_bert, roformer, rt_detr, rt_detr_resnet, rt_detr_v2, rwkv, sam, seamless_m4t, seamless_m4t_v2, segformer, seggpt, sew, sew-d, shieldgemma2, siglip, siglip2, siglip_vision_model, smolvlm, smolvlm_vision, speech-encoder-decoder, speech_to_text, speech_to_text_2, speecht5, splinter, squeezebert, stablelm, starcoder2, superglue, superpoint, swiftformer, swin, swin2sr, swinv2, switch_transformers, t5, table-transformer, tapas, textnet, time_series_transformer, timesformer, timm_backbone, timm_wrapper, trajectory_transformer, transfo-xl, trocr, tvlt, tvp, udop, umt5, unispeech, unispeech-sat, univnet, upernet, van, video_llava, videomae, vilt, vipllava, vision-encoder-decoder, vision-text-dual-encoder, visual_bert, vit, vit_hybrid, vit_mae, vit_msn, vitdet, vitmatte, vitpose, vitpose_backbone, vits, vivit, wav2vec2, wav2vec2-bert, wav2vec2-conformer, wavlm, whisper, xclip, xglm, xlm, xlm-prophetnet, xlm-roberta, xlm-roberta-xl, xlnet, xmod, yolos, yoso, zamba, zamba2, zoedepth
Will use TF-IDF fallback for text similarity
MerchantMatchingSystem initialized successfully
Loading reference data...
Loading reference data from: Acronym_Categorized.xlsx
Detected Acronym_Categorized.xlsx format with columns: 'Acronym', 'Full Name', 'Merchant Category'
Building category-specific indices...
Generating TF-IDF vectors for category: Banking
Generating TF-IDF vectors for category: Telecom
Generating TF-IDF vectors for category: Government
Generating TF-IDF vectors for category: Insurance
Generating TF-IDF vectors for category: Automobile
Generating TF-IDF vectors for category: Grocery
Generating TF-IDF vectors for category: Misc Speciality
Generating TF-IDF vectors for category: Postal Service
Generating TF-IDF vectors for category: Sports
Generating TF-IDF vectors for category: Travel
Generating TF-IDF vectors for category: Software IT
Generating TF-IDF vectors for category: Pharmacy
Generating TF-IDF vectors for category: Beer Store
Generating TF-IDF vectors for category: Logistics
Generating TF-IDF vectors for category: Credit Agency
Generating TF-IDF vectors for category: Machinery
Generating TF-IDF vectors for category: Electric components
Generating TF-IDF vectors for category: Minning
Generating TF-IDF vectors for category: Electronics
Generating TF-IDF vectors for category: Restaurant
Generating TF-IDF vectors for category: Supermart
Generating TF-IDF vectors for category: Clothing
Generating TF-IDF vectors for category: Mens/womens wear
Generating TF-IDF vectors for category: Shoe Store
Built indices for 24 categories
Building acronym dictionary...
Built acronym dictionary with 75 unique acronyms across 76 categories
Loaded 98 reference merchants across 24 categories
Saving model...
Model saved to merchant_matcher.pkl
Processing with algorithm comparison...
Processing batch from: Acronym_Categorized.xlsx
Resolved acronym 'ANZ' to 'Australia and New Zealand Banking Group'
Error: X has 15 features, but NearestNeighbors is expecting 16 features as input.
Traceback (most recent call last):
  File "/tmp/ipykernel_490/1487817505.py", line 36, in main
    matcher.batch_process("Acronym_Categorized.xlsx",
  File "/tmp/ipykernel_490/2822751763.py", line 698, in batch_process
    matches = self.find_matches(
              ^^^^^^^^^^^^^^^^^^
  File "/tmp/ipykernel_490/2822751763.py", line 503, in find_matches
    return self._find_matches_in_category(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/ipykernel_490/2822751763.py", line 540, in _find_matches_in_category
    distances, indices = index.kneighbors(query_embedding, n_neighbors=min(top_k * 2, len(embeddings)))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/sklearn/neighbors/_base.py", line 804, in kneighbors
    X = self._validate_data(X, accept_sparse="csr", reset=False, order="C")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/sklearn/base.py", line 626, in _validate_data
    self._check_n_features(X, reset=reset)
  File "/opt/conda/lib/python3.11/site-packages/sklearn/base.py", line 415, in _check_n_features
    raise ValueError(
ValueError: X has 15 features, but NearestNeighbors is expecting 16 features as input.
